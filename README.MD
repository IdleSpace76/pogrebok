# Pogrebok <br/>

Telegram –±–æ—Ç - –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ Spring Boot –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–µ–π Long Polling.</br>
–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è —Å–∫–æ—Ä–µ–µ –∫–∞–∫ —Å–∫–µ–ª–µ—Ç –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ—Ç–æ–≤ –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ (–∏ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è —Å Telegram API).</br>

_________________

## –°—Ç–µ–∫:
- Java 21
- Apache Maven
- Spring Boot 3.5.5
- Telegram Bots Long Polling –∏ Telegram Bots Client v. 9.0.0
- Apache Kafka
- Docker
- Postgres
- Liquibase

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](/docs/images/architecture.png)

## –ü–ª–∞–Ω:
- [x] –°–æ–∑–¥–∞—Ç—å dispatcher (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)
- [x] –ü–æ–¥–∫–ª—é—á–∏—Ç—å –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (Apache Kafka + Kraft)
- [x] –°–æ–∑–¥–∞—Ç—å Node-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (–±–∏–∑–Ω–µ—Å)
- [x] –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ (file-service)
- [x] –°–æ–∑–¥–∞—Ç—å mail-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (–†–∞—Å—Å—ã–ª–∫–∞ –ø–æ—á—Ç—ã)
- [x] –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Apache JMeter)
- [x] –ü–æ—Å–µ–ª–∏—Ç—å –≤—Å–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (docker-compose)
- [x] –û—Ñ–æ—Ä–º–∏—Ç—å README (–æ–ø–∏—Å–∞–Ω–∏–µ + —Å—Ö–µ–º–∞)

### Docker:
–ü—Ä–µ–∂–¥–µ —á–µ–º –∫–æ–º–ø–æ–∑–∏—Ç—å –æ–±—Ä–∞–∑, –Ω—É–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ base.env –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ–≥–æ –≤ .env (–Ω–µ –≥–æ–≤–æ—Ä—è –æ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º 
Docker Engine –∏ –ø—Ä–æ—á–µ–π –±–∞–∑–µ).
> –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑: </br>
> docker compose build
> 
> –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å 3–º—è –Ω–æ–¥–∞–º–∏: </br>
> docker compose up --build --scale node=3
> 
> –°–æ–±—Ä–∞—Ç—å "—á–∏—Å—Ç—ã–π" –æ–±—Ä–∞–∑: </br>
> docker compose build --no-cache
> 
> –ó–∞–ø—É—Å–∫ / –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: </br>
> docker-compose up -d <br/>
> docker-compose down -v <br/>

### üìä –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (JMeter 5.6.3)
–ë—ã–ª –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –±–∞–∑–æ–≤—ã–π –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –ø–æ–º–æ—â—å—é **JMeter 5.6.3**.

–°–µ—Ä–≤–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É ~2 000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É —Å 
–Ω—É–ª–µ–≤–æ–π –¥–æ–ª–µ–π –æ—à–∏–±–æ–∫, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–µ–º–ª–µ–º—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

- –°—Ü–µ–Ω–∞—Ä–∏–π: `GET /file/image?id={hashId}`
- 10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, ramp-up 5 —Å–µ–∫, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 30 —Å–µ–∫
- –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 63 770 ‚Ä¢ –û—à–∏–±–æ–∫: **0%**
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: **~4 ms** ‚Ä¢ Max: 96 ms
- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å: **~2 100 req/sec**

–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–Ω: `docs/jmeter/file-image-load.jmx`.

> [!TIP]
> –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ª—É—á—à–µ, –Ω–æ –Ω–µ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ, —Ç.–∫. –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ mvp –ø—Ä–æ–µ–∫—Ç–∞:
> 1) –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞ –∏–∑ –¢–ì –Ω–µ –∑–∞–±–∏–≤–∞—Ç—å –∏–º –ø–∞–º—è—Ç—å, –∞ —Å—Ç—Ä–∏–º–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ –±–¥ (–ª—É—á—à–µ –≤–æ–≤—Å–µ —Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ –≤ –±–¥)
> 2) UUID –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π, —á—Ç–æ–±—ã –≥–æ—Ç–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞ —Ç–æ—á–Ω–æ –±—ã–ª–∏ —Ä–∞–∑–Ω—ã–º–∏
> 3) –í—ã–Ω–µ—Å—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å
